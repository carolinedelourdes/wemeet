<!doctype html>
<html class="no-js" lang="en"><html>
<head>
	<title>We Meet</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
	<meta charset="utf-8" />
	<link rel="stylesheet" href="../css/foundation.css" />
	<link rel="stylesheet" href="../css/foundation-icons/foundation-icons.css" />
	<link href='http://fonts.googleapis.com/css?family=Roboto:300,700,400' rel='stylesheet' type='text/css'>
	<link href="../style.css" rel="stylesheet" type="text/css"/>
	<script src="../js/vendor/modernizr.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js?v=3&amp;libraries=places"></script>
	<script>
	var map;
	var service;
	function initializeMap() {
		var mapCanvas = document.getElementById('map-canvas');
		var mapOptions = {
			center: new google.maps.LatLng(34.201167, -118.923688),
			zoom: 12,
			mapTypeId: google.maps.MapTypeId.ROADMAP,
			scrollwheel: false,
			streetViewControl: false,
			mapTypeControl: false
		}
		map = new google.maps.Map(mapCanvas, mapOptions)	        
		var friends = [
		{ 
			coordinates: new google.maps.LatLng(34.189764,-118.844758),
			title: 'Matt Guyadeen',
			photo: 'http://lorempixel.com/50/50/people?f=0'

		},
		{
			coordinates: new google.maps.LatLng(34.201167,-118.923688),
			title: 'Vinit Varghese',
			photo: 'http://lorempixel.com/50/50/people?f=1'
		},
		{ 
			coordinates: new google.maps.LatLng(34.276141,-119.295788),
			title: 'The German',
			photo: 'http://lorempixel.com/50/50/people?f=3'
		}
		];
		var numFriends = 3;
	    
	    // create a marker for each friend
        for(i = 0; i < numFriends; i++)
        {
        	var marker = new google.maps.Marker({
        		position: friends[i].coordinates,
        		map: map,
        		title: friends[i].title,
        		icon: friends[i].photo,
        		optimized: false // to allow for styling in overlay div
        	});
        }

        // layer to allow for marker styling
         var overlay = new google.maps.OverlayView();
	     overlay.draw = function () {
	         this.getPanes().markerLayer.id='markerLayer';
	     };
    	 overlay.setMap(map);

        // draw the boundary box for all of the friends
        var bounds = new google.maps.LatLngBounds ();
        for (var i = 0; i < numFriends; i++) {
        	bounds.extend(friends[i].coordinates);
        }
		//  Fit these bounds to the map
		map.fitBounds(bounds)
		// Get center of the boundary box, add as marker
		var centerPoint = bounds.getCenter()
		var centerIcon = new google.maps.MarkerImage('http://maps.google.com/mapfiles/ms/icons/flag.png', null, null, null, new google.maps.Size(32,32));
		var centerMarker = new google.maps.Marker({
			position: centerPoint,
			map: map,
			title: 'Center Point',
			icon: centerIcon,
		});
		// array to store search markers
		var searchMarkers = [];
		// make sure search box is enabled
		$("#search-stuff input").prop("disabled",false)
		
		service = new google.maps.places.PlacesService(map)
		// search box submit
		$("#search-stuff").submit(function(event) {			
			mapRequest($("#search-stuff").children("input").val())
			event.preventDefault()
			return false
		});
		// friend like submit
		$( "#likes li" ).click(function() {
  			mapRequest($(this).text())
		});

		function mapRequest(query)
		{
			// remove previous search markers
			for (var i = 0, marker; marker = searchMarkers[i]; i++) {
	     			marker.setMap(null)
	    	}
    		// search within 5 mile radius of center point, and draw markers for them
	 		var request = {
				keyword: query,
				location: centerPoint,
				radius: 10000,
				types: ['establishment']//,
				//rankBy: google.maps.places.RankBy.DISTANCE
			}
			service.nearbySearch(request, callback)
		}
		// display search markers
		function callback(results, status) {
			if (status == google.maps.places.PlacesServiceStatus.OK) {
				var numResults = results.length
				$("#no-results").fadeOut("fast")
				for (var i = 0; i < numResults; i++) {
					createMarker(results[i])
				}				
				// make sure the center marker is always visible
				centerMarker.setZIndex(google.maps.Marker.MAX_ZINDEX + 1);
			}
			else if (status == google.maps.places.PlacesServiceStatus.ZERO_RESULTS) 
			{
				$("#no-results").fadeIn("slow")
			} 
			// make sure search input is enabled
			$("#search-stuff input").prop("disabled",false)
		}
		// draw new marker for search result
		function createMarker(place) {
			var placeLoc = place.geometry.location
			var marker = new google.maps.Marker({
				title: place.name,
				map: map,
				position: place.geometry.location
			});
			searchMarkers.push(marker)
		}
		}
		// init map
		google.maps.event.addDomListener(window, 'load', initializeMap)

		</script>
		<style>
			#markerLayer img {
			    max-width: 1.5rem;
			    max-height: 1.5rem;
			    border-radius: 1.5rem;
			}
		</style>
	</head>
	<body>
		<main>
			<!--<div class="row">-->
		<!-- <section id="introduction" class="small-12 medium-centered columns">
			<h1>WeMeet</h1>
			<p>Find places to meet with your friends.</p>
			<button id="facebook-login" onclick="FB.login(WeMeetFacebook.statusChangeCallback)" disabled>Checking Facebook...</button>
		</section>-->
		<!--<section id="who" class="small-12 medium-centered columns" >
	</section>-->		
	<!-- </div> -->
	<section id="what" style="display:block;">
		<div id="what-intro">
			<div class="row">
				<div class=" small-12 medium-centered columns">
					<h1>What do you want to do?</h1>
				</div>
			</div>
			<div class="row">
				<form id="search-stuff" class="small-12 small-centered columns">
					<input disabled type="search" placeholder="Search for things to do..."/> 
				</form>
			</div>
		</div>
		<div id="no-results">
			No results.
		</div>
		<div id="map-canvas"></div>
		<section id="who-is">
			<div class="row">
				<div class="small-12 columns">
					<h2>Who is here?</h2>
				</div>
			</div>
			<div class="row">				
				<div class="friend unselected small-6 medium-4 large-3 columns">
					<div class="profile-photo">		
						<div class="photo-wrap">
							<img src="http://lorempixel.com/300/300/people?f=0" alt="Jane Smith Profile Photo"/>
						</div>
					</div>
					<div class="details">		
						<div class="friend-name">Matt Guyadeen</div>
						<div class="friend-location">Thousand Oaks</div>
					</div>
				</div>
				<div class="friend unselected small-6 medium-4 large-3 columns" >			
					<div class="profile-photo">	
						<div class="photo-wrap">	
							<img src="http://lorempixel.com/300/300/people?f=1" alt="Jane Smith Profile Photo"/>
						</div>
					</div>
					<div class="details">
						<div class="friend-name">Vinit Varghese</div>
						<div class="friend-location">Newbury Park</div>
					</div>						
				</div>
				<div class="friend unselected small-6 medium-4 large-3 columns" >
					<div class="profile-photo">
						<div class="photo-wrap">
							<img src="http://lorempixel.com/300/300/people?f=2" alt="Jane Smith Profile Photo"/>
						</div>
					</div>
					<div class="details">
						<div class="friend-name">The German</div>
						<div class="friend-location">Ventura, CA</div>
					</div>						
				</div>					
			</section>
			<section id="likes">
				<div class="row">
					<div class="small-12 columns">
						<h2>Liked by your friends</h2>
					</div>
				</div>
				<div class="row">
					<div class="small-6 medium-4 large-3 columns">
						<ul>
							<li><span class="clickable">Pizza</span></li>
							<li><span class="clickable">Pho</span></li>
							<li><span class="clickable">Subway</span></li>
							<li><span class="clickable">Chipotle</span></li>
							<li><span class="clickable">Korean BBQ</span></li>
						</ul>
					</div>
					<div class="small-6 medium-4 large-3 columns">
						<ul>
							<li><span class="clickable">Tacos</span></li>
							<li><span class="clickable">Sushi</span></li>
							<li><span class="clickable">Vegetarian</span></li>
							<li><span class="clickable">Pho</span></li>
							<li><span class="clickable">Subway</span></li>
						</ul>
					</div>
					<div class="small-6 medium-4 large-3 columns">
						<ul>
							<li><span class="clickable">Pizza</span></li>
							<li><span class="clickable">Pho</span></li>
							<li><span class="clickable">Subway</span></li>
							<li><span class="clickable">Chipotle</span></li>
							<li><span class="clickable">Korean BBQ</span></li>
						</ul>
					</div>
					<div class="small-6 medium-4 large-3 columns">
						<ul>
							<li><span class="clickable">Chipotle</span></li>
							<li><span class="clickable">Korean BBQ</span></li>
							<li><span class="clickable">Pizza</span></li>
							<li><span class="clickable">Pho</span></li>
							<li><span class="clickable">Subway</span></li>
						</ul>
					</div>
				</div>					
			</section>
		</section>
	</main>
	<script src="../js/vendor/jquery.js"></script>	
	<script src="../js/foundation.min.js"></script>
	<script>
	$(document).foundation();
	</script>
	<script>
	$(document).ready(function(){			
		var mapHeight = $(window).height() - $("#what").height()
		$("#map-canvas").height(mapHeight)
	});
	</script>
	<!--<script src="script.js"></script>
	<script src="facebook.js"></script>-->
</body>
</html>